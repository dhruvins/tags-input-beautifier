/*!
 * =======================================================
 *  SIMPLEST TAGS INPUT BEAUTIFIER 2.1.0
 * =======================================================
 *
 *   Author: Taufik Nurrohman
 *   URL: https://github.com/tovic
 *   License: MIT
 *
 * -- USAGE: ---------------------------------------------
 *
 *   var tags = new TIB(document.querySelector('input'));
 *
 * -------------------------------------------------------
 *
 */
!function(e,t,n){function y(e){return t.createElement(e)}function x(e){return Object.keys(e)}function C(e){return x(e).length}var i="__instance__",r=setTimeout,a="innerHTML",s="textContent",o="className",f="classes",u="toLowerCase",l="replace",c="firstChild",p="parentNode",g="nextSibling",d="previousSibling",v="appendChild",h="insertBefore",b="removeChild",m="setAttribute",w="getAttribute",j="preventDefault",k="addEventListener";!function(e){e.version="2.1.0",e[i]={},e.each=function(t,n){return r(function(){var r,n=e[i];for(r in n)t(n[r],r,n)},0===n?0:n||1),e}}(e[n]=function(t,T){function O(){B.focus()}function H(e){var n,t=e?this:B;r(function(){n=t[s].split(L.join);for(K in n)D.set(n[K],1)},1)}var B,K,D=this,_=Date.now(),E=t.placeholder||"",L={join:", ",max:9999,escape:[",","\n"],alert:!0,text:["Delete “%s” Tag","Duplicate “%s” Tag"],classes:["tags","tag","tags-input","tags-output","tags-view"],update:function(){}},N=y("span"),S=y("span"),A="data-tag";e[n][i][t.id||t.name||C(e[n][i])]=D,T="string"==typeof T?{join:T}:T||{};for(K in L)"undefined"!=typeof T[K]&&(L[K]=T[K]);t[o]=L[f][3],N[o]=L[f][0]+" "+L[f][0]+"-"+_,N[k]("click",O,!1),N.id=t.id||L[f][0]+"-"+_,N[a]='<span class="'+L[f][4]+'"></span>',S[o]=L[f][2],S[a]='<span contenteditable spellcheck="false" style="white-space:pre;outline:none;"></span><span>'+E+"</span>",t[p][h](N,t[g]||null),N[c][v](S),B=S[c],D.tags={},D.error=0,D.filter=function(e){return(e+"")[l](new RegExp("["+L.join[l](/\s/g,"")+"]|^\\s+|\\s+$|\\s{2,}","g"),"")[u]()},D.update=function(e,n){for(t.value="";(K=N[c][c])&&K[w](A);)N[c][b](K);e=0!==e?e:x(D.tags);for(K in e)D.set(e[K],1,n);return L.update(D),D},D.reset=function(e){return e=D.filter(e||""),e?delete D.tags[e]:D.tags={},D.update(0,1)},D.set=function(e,n,i){if(e=D.filter(e),""===e||C(D.tags)===L.max)return B[a]="",D;var r=y("span"),s=y("a");if(r[o]=L[f][1],r[m](A,e),s.href="javascript:;",s.title=(L.text[0]||"")[l](/%s/g,e),s[k]("click",function(e){var t=this,n=t[p],i=t[p][w](A);n[p][b](n),D.reset(i),O(),e[j]()},!1),r[v](s),D.tags[e]){if(B[a]="",i)N[c][h](r,S);else if(L.alert){D.error=1;var u=L.text[1][l](/%s/g,e);"function"==typeof L.alert?L.alert(u,e,D):alert(u)}}else D.tags[e]=1,N[c][h](r,S);return t.value=x(D.tags).join(L.join),n&&(B[a]=""),!i&&L.update(D),D},function(){return B[k]("blur",function(){D.error=0,D.set(this[s]),this[a]=""},!1),B[k]("paste",H,!1),B[k]("keydown",function(e){D.error=0;var m,t=this,n=e.keyCode,i=N,o=(e.key||String.fromCharCode(n))[u](),f=e.ctrlKey,l=e.shiftKey,c=S[d]&&S[d][w](A),v=B[g],h="tab"===o||!l&&9===n,b="enter"===o||!l&&13===n;if(f&&b){for(;i=i[p];)if("form"===i.nodeName[u]()){m=i;break}D.set(t[s],1),0===D.error&&m&&m.submit()}else if(f&&("v"===o||!l&&86===n))H();else{var k=L.escape;for(K in k)if("	"===k[K]&&h||"\n"===k[K]&&b)return r(function(){D.set(t[s],1),O()},1),void e[j]();r(function(){var i,e=t[s];if(v[a]=e?"":E,e||"backspace"!==o&&(l||8!==n)){for(K=0,i=k.length;i>K;++K)if(k[K]&&-1!==e.indexOf(k[K])){D.set(e.split(k[K]).join(""),1);break}}else D.reset(c),O()},1)}},!1),D}(),D.update(t.value.split(L.join),1),D.config=L,D.input=S,D.view=N,D.target=D.output=t})}(window,document,"TIB");