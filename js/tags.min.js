/**
 * =====================================================
 *  SIMPLEST TAGS INPUT BEAUTIFIER
 * =====================================================
 *
 *  Author: Taufik Nurrohman
 *  URL: https://github.com/tovic, http://latitudu.com
 *  License: MIT
 *
 * -- USAGE: -------------------------------------------
 * var foo = new Tags(document.querySelector('input'));
 * foo.beautify();
 * -----------------------------------------------------
 *
 */

var Tags=function(e,t){var a=this,n={join:", ",max:9999,d_text:"Duplicate %s Tag",r_text:"Remove %s Tag",i_class:"tags-input",o_class:"tags-output",w_class:"tags"};"string"==typeof t&&(t={join:t});for(var i in n)void 0===t[i]&&(t[i]=n[i]);a.input=e,a.config=t,a.output=null,a.tags={},a.slug=function(e){return e.replace(/[\s,]/g,"").toLowerCase()},a.clear=function(){return a.input.value="",!1},a.draw=function(){var e=a.input,n=e.name,i=document.createElement("label");a.output=document.createElement("input"),a.output.name=n,a.output.type="hidden",a.input.removeAttribute("name"),e.className+=" "+t.i_class,i.className=t.w_class,i.innerHTML='<span class="'+t.o_class+'"></span>',e.parentNode.insertBefore(i,e),i.appendChild(e),i.appendChild(a.output)},a.beautify=function(){a.draw(),e.onkeydown=function(n){var i=e.previousSibling,r=n.keyCode,s=a.slug(this.value),u=document.createElement("span"),o=document.createElement("a");if(setTimeout(function(){var e=Object.keys(a.tags).join(t.join);a.output!==!1&&(a.output.value=e)},1),""===s&&8===r){var l=i.lastChild;if(l){var c=l.children[0].getAttribute("data-key");i.removeChild(l),delete a.tags[c]}return!1}return n.shiftKey||188!==r&&32!==r&&13!==r?void 0:""===s?a.clear():(this.value="",Object.keys(a.tags).length===t.max?a.clear():s in a.tags?(alert(t.d_text.replace(/%s/g,s)),a.clear()):(u.innerHTML=s,o.title=t.r_text.replace(/%s/g,s),o.setAttribute("data-key",s),o.href="#tag:remove",o.innerHTML="&times",o.onclick=function(){return delete a.tags[this.getAttribute("data-key")],this.parentNode.parentNode.removeChild(this.parentNode),!1},u.appendChild(o),i.appendChild(u),a.tags[s]=1,!1))}}};